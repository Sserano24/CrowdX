{% extends 'campaign/base.html' %}
{% load static %}
{% block content %}
<!DOCTYPE html>
<html>
<head>
    <title>Stripe Payment</title>
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
    <h1>Make a Payment</h1>
    <form id="payment-form" method="POST" action="/payments/create-checkout-session/">
        {% csrf_token %}
        <label for="amount">Enter Payment Amount ($):</label>
        <input type="number" id="amount" name="amount" min="1" step="0.01" required>
        <button type="submit" id="submit-button">Pay Now</button>
    </form>

    <script>
        const paymentSocket = new WebSocket('ws://127.0.0.1:8000/ws/payment-status/');

        paymentSocket.onopen = function(e) {
            console.log('WebSocket connected');
            paymentSocket.send(JSON.stringify({'message': 'Hello WebSocket!'}));
        };

        paymentSocket.onmessage = function(e) {
            const data = JSON.parse(e.data);
            console.log('Message from server: ', data.message);
        };

        paymentSocket.onclose = function(e) {
            console.error('WebSocket closed unexpectedly');
        };

        paymentSocket.onerror = function(e) {
            console.error('WebSocket encountered an error: ', e);
        };
    </script>
</body>
</html>
{% endblock %}
